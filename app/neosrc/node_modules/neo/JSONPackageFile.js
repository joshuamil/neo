const lineByLine = require('n-readlines');
const log = require('log');

/** Acts as a wrapper around a JSON package file. See the FILEFORMAT.md document
for details about JSON package files. */
self = module.exports = class JSONPackageFile {
  /** Construct a new JSONPackageFile object given a path to the physical file. */
  constructor(filePath) {
    this._filePath = filePath;
  }

  get typeURL() {
    if (!this._typeURL) {
      this.readHeader();
    }

    return this._typeURL;
  }


  get metadata() {

  }

  readHeader() {
    var lineReader = new lineByLine(this._filePath);
    var line = lineReader.next().toString();
    if (line.trim() != '[') {
      log.error('JSONPackageFile expected [, received ', line);
      return false;
    }
    line = lineReader.next();

    this._typeURL = JSON.parse('[' + line + ' null]')[0];
  }
}
